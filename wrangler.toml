name = "rushomon"
main = "build/worker/shim.mjs"
compatibility_date = "2026-02-11"

[build]
command = "cargo install -q worker-build && worker-build --release"

# KV Namespace for URL mappings
# Run: wrangler kv:namespace create "URL_MAPPINGS"
# Then update the id below with the returned namespace ID
[[kv_namespaces]]
binding = "URL_MAPPINGS"
id = "8bd613d0dfc4464189531023547c79f5"
preview_id = "48136fe5129f406184e6956849b5280f"

# D1 Database for metadata and analytics
# Run: wrangler d1 create rushomon
# Then update the database_id below with the returned ID
[[d1_databases]]
binding = "rushomon"
database_name = "rushomon"
database_id = "3770f758-a236-41e3-b158-58c6a6253da8"

# Environment variables (non-sensitive)
[vars]
GITHUB_CLIENT_ID = "your-github-oauth-app-client-id"
DOMAIN = "yourdomain.com"
FRONTEND_URL = "http://localhost:5173"

# CORS configuration
# Comma-separated list of allowed origins
ALLOWED_ORIGINS = "http://localhost:5173,http://localhost:5174,https://rushomon-ui.pages.dev"
# Pattern for ephemeral environments (use {} as placeholder for PR number)
EPHEMERAL_ORIGIN_PATTERN = "https://pr-{}.rushomon-ui.pages.dev"

# Secrets (sensitive values - set via wrangler secret put)
# Run these commands to set secrets:
# wrangler secret put GITHUB_CLIENT_SECRET
# wrangler secret put JWT_SECRET (use a random 32+ character string)
